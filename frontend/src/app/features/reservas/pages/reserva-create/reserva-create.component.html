<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <div class="card shadow-lg border-0">
        <div class="card-header bg-primary text-white py-3">
          <h3 class="mb-0 fw-bold">
            <i class="bi bi-calendar-plus me-2"></i>
            Reservar en {{ restaurantName }}
          </h3>
        </div>
        <div class="card-body p-4">
          <form [formGroup]="reservaForm" (ngSubmit)="onSubmit()">

            <!-- Restaurante (Solo visible si NO venimos de un restaurante específico) -->
            <div class="mb-3" *ngIf="!restaurantId && isStaff">
              <label for="restaurantId" class="form-label fw-bold">Selecciona Restaurante</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-shop"></i></span>
                <select class="form-select" id="restaurantId" formControlName="restaurantId">
                  <option *ngFor="let rest of restaurantes" [value]="rest.id">{{ rest.nombre }}</option>
                </select>
              </div>
              <div class="form-text text-muted small">Selecciona el restaurante para esta reserva.</div>
            </div>

            <!-- Nombre -->
            <div class="mb-3">
              <label for="nombreCliente" class="form-label fw-bold">Nombre Completo</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-person"></i></span>
                <input type="text" class="form-control" id="nombreCliente" formControlName="nombreCliente" placeholder="Ej: Juan Pérez"
                       [ngClass]="{'is-invalid': reservaForm.get('nombreCliente')?.invalid && reservaForm.get('nombreCliente')?.touched}">
              </div>
              <div class="invalid-feedback">
                El nombre es obligatorio (mínimo 3 caracteres).
              </div>
            </div>

            <!-- Teléfono -->
            <div class="mb-3">
              <label for="telefono" class="form-label fw-bold">Teléfono Móvil</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-phone"></i></span>
                <input type="tel" class="form-control" id="telefono" formControlName="telefono" placeholder="600123456"
                       [ngClass]="{'is-invalid': reservaForm.get('telefono')?.invalid && reservaForm.get('telefono')?.touched}">
              </div>
              <div class="form-text text-muted small">Te enviaremos un SMS de confirmación.</div>
              <div class="invalid-feedback">
                Introduce un número de teléfono válido (9 dígitos).
              </div>
            </div>

            <div class="row">
              <!-- Fecha y Hora -->
              <div class="col-md-6 mb-3">
                <label for="fechaHora" class="form-label fw-bold">Fecha y Hora</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="bi bi-clock"></i></span>
                  <input type="datetime-local" class="form-control" id="fechaHora" formControlName="fechaHora"
                         [ngClass]="{'is-invalid': reservaForm.get('fechaHora')?.invalid && reservaForm.get('fechaHora')?.touched}">
                </div>
                <div class="invalid-feedback">
                  Selecciona cuándo quieres venir.
                </div>
              </div>

              <!-- Número de Personas -->
              <div class="col-md-6 mb-3">
                <label for="numeroPersonas" class="form-label fw-bold">Comensales</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="bi bi-people"></i></span>
                  <input type="number" class="form-control" id="numeroPersonas" formControlName="numeroPersonas" min="1" max="20"
                         [ngClass]="{'is-invalid': reservaForm.get('numeroPersonas')?.invalid && reservaForm.get('numeroPersonas')?.touched}">
                </div>
                <div class="invalid-feedback">
                  Mínimo 1 persona, máximo 20.
                </div>
              </div>
            </div>

            <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
              <button type="button" class="btn btn-light me-md-2" [routerLink]="restaurantId ? ['/restaurante', restaurantId, 'menu'] : '/reservas'">
                Cancelar
              </button>
              <button type="submit" class="btn btn-primary px-4" [disabled]="reservaForm.invalid">
                Confirmar Reserva
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
